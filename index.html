<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COT - Control de Kilómetros</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- ======================
     PANTALLA PRINCIPAL
====================== -->
<div id="mainScreen" class="screen active">
    <h1>Control de Kilómetros</h1>
    <button onclick="showScreen('travelScreen')">Registrar Viaje</button>
    <button onclick="showScreen('guardScreen')">Registrar Guardia</button>

    <h2>Resumen</h2>
    <p><strong>Kilómetros Trabajados:</strong> <span id="kmTrabajados">0</span></p>
    <p><strong>Kilómetros Pasajero:</strong> <span id="kmPasajero">0</span></p>
    <p><strong>Guardias:</strong> <span id="cantGuardias">0</span></p>
</div>


<!-- ======================
     PANTALLA REGISTRAR VIAJE
====================== -->
<div id="travelScreen" class="screen">
    <div class="header">
        <button class="back-btn" onclick="showScreen('mainScreen')">←</button>
        <div class="header-title">
            <h1>Registrar Viaje</h1>
            <p>Complete los datos del servicio</p>
        </div>
    </div>

    <div class="form-group">
        <label>Fecha del Viaje:</label>
        <div class="btn-group">
            <button type="button" class="btn-date" onclick="setFecha('fechaViaje', 0)">Hoy</button>
            <button type="button" class="btn-date" onclick="setFecha('fechaViaje', -1)">Ayer</button>
            <button type="button" class="btn-date" onclick="setFecha('fechaViaje', -2)">Hace 2 días</button>
        </div>
        <input type="date" id="fechaViaje">
    </div>

    <div class="form-group">
        <label>Número de Orden:</label>
        <input type="number" id="orderNumber" placeholder="Ej: 123">
    </div>

    <div class="form-group">
        <label>Origen:</label>
        <input type="text" id="origin" placeholder="Ej: Montevideo">
    </div>

    <div class="form-group">
        <label>Destino:</label>
        <input type="text" id="destination" placeholder="Ej: Punta del Este">
    </div>

    <div class="form-group">
        <label>Turno:</label>
        <select id="turno">
            <option value="1">1 - Común</option>
            <option value="2">2 - Directo / Acoplado</option>
            <option value="3">3 - Segundo acoplado</option>
        </select>
    </div>

    <div class="form-group">
        <label>Kilómetros:</label>
        <input type="number" id="km" step="0.1" placeholder="Ej: 140">
    </div>

    <div class="form-group">
        <label>Horarios:</label>
        <div class="time-group">
            <input type="time" id="departureTime">
            <input type="time" id="arrivalTime">
        </div>
    </div>

    <div class="form-group">
        <label>Tipo:</label>
        <select id="travelType">
            <option value="working">Trabajando</option>
            <option value="passenger">De Pasajero</option>
        </select>
    </div>

    <button onclick="addTravel()">Agregar Viaje</button>
</div>


<!-- ======================
     PANTALLA REGISTRAR GUARDIA
====================== -->
<div id="guardScreen" class="screen">
    <div class="header">
        <button class="back-btn" onclick="showScreen('mainScreen')">←</button>
        <h1>Registrar Guardia</h1>
    </div>

    <div class="form-group">
        <label>Fecha:</label>
        <input type="date" id="guardDate">
    </div>

    <div class="form-group">
        <label>Número de Orden:</label>
        <input type="number" id="guardOrder">
    </div>

    <div class="form-group">
        <label>Horario:</label>
        <div class="time-group">
            <input type="time" id="guardStart">
            <input type="time" id="guardEnd">
        </div>
    </div>

    <button onclick="addGuard()">Agregar Guardia</button>
</div>


<!-- ======================
     LISTA DE REGISTROS
====================== -->
<div id="recordsScreen" class="screen">
    <div class="header">
        <button class="back-btn" onclick="showScreen('mainScreen')">←</button>
        <h1>Registros</h1>
    </div>

    <div id="recordsList"></div>
</div>


<!-- ======================
     SCRIPT PRINCIPAL
====================== -->
<script>

/* =============================
   CAMBIO DE PANTALLA
============================= */
function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}


/* =============================
   SETEAR FECHA RÁPIDA
============================= */
function setFecha(id, offset) {
    const d = new Date();
    d.setDate(d.getDate() + offset);
    document.getElementById(id).value = d.toISOString().split("T")[0];
}


/* =============================
   AGREGAR VIAJE (VERSIÓN CORRECTA)
============================= */
function addTravel() {
    const date = document.getElementById('fechaViaje').value;
    const orderNumber = document.getElementById('orderNumber').value.trim();
    const origin = document.getElementById('origin').value.trim();
    const destination = document.getElementById('destination').value.trim();
    const turno = parseInt(document.getElementById('turno').value);
    const km = parseFloat(document.getElementById('km').value);
    const horaSalida = document.getElementById('departureTime').value;
    const horaLlegada = document.getElementById('arrivalTime').value;
    const type = document.getElementById('travelType').value;

    if (!date || !orderNumber || !origin || !destination || isNaN(km) || !horaSalida || !horaLlegada) {
        alert("Complete todos los campos.");
        return;
    }

    const newTravel = {
        type: "travel",
        date,
        orderNumber,
        origin,
        destination,
        turno,
        km,
        horaSalida,
        horaLlegada,
        travelType: type,
        viaticos: 0
    };

    let travels = JSON.parse(localStorage.getItem("bus_travels")) || [];
    travels.push(newTravel);
    localStorage.setItem("bus_travels", JSON.stringify(travels));

    alert("Viaje registrado correctamente.");
    updateSummary();
    showScreen("mainScreen");
}


/* =============================
   REGISTRAR GUARDIA
============================= */
function addGuard() {
    const date = document.getElementById('guardDate').value;
    const order = document.getElementById('guardOrder').value;
    const start = document.getElementById('guardStart').value;
    const end = document.getElementById('guardEnd').value;

    if (!date || !order || !start || !end) {
        alert("Complete todos los campos.");
        return;
    }

    const guard = {
        type: "guard",
        date,
        orderNumber: order,
        horaSalida: start,
        horaLlegada: end,
        viaticos: 0
    };

    let records = JSON.parse(localStorage.getItem("bus_travels")) || [];
    records.push(guard);
    localStorage.setItem("bus_travels", JSON.stringify(records));

    updateSummary();
    showScreen("mainScreen");
}


/* =============================
   ACTUALIZAR RESUMEN
============================= */
function updateSummary() {
    const data = JSON.parse(localStorage.getItem("bus_travels")) || [];

    let kmTrab = 0;
    let kmPas = 0;
    let cantGuard = 0;

    data.forEach(item => {
        if (item.type === "travel") {
            if (item.travelType === "working") kmTrab += item.km;
            else kmPas += item.km;
        }
        if (item.type === "guard") cantGuard++;
    });

    document.getElementById("kmTrabajados").textContent = kmTrab;
    document.getElementById("kmPasajero").textContent = kmPas;
    document.getElementById("cantGuardias").textContent = cantGuard;
}

updateSummary();

</script>

</body>
</html>







































