<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gesti√≥n de Viajes</title>
<link rel="stylesheet" href="style.css">

<style>
/* ========== PANTALLAS GENERALES ========== */
.screen{
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%;
  height:100%;
  overflow-y:auto;
  background:white;
}

.screen.active{ display:block; }

/* ========== SPLASH DISCRETO ========== */
#splashScreen{
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  align-items:center;
  padding-bottom:30px;
  background:white;
}

.splash-text{
  font-size:14px;
  color:#777;
}

/* ========== HEADER AZUL (nuestro ‚Äúsplash visual‚Äù) ========== */
.header-bar{
  background:#6b5cff;
  color:white;
  padding:18px 16px;
}

.header-bar h1{
  margin:0;
  font-size:20px;
}

.header-bar p{
  margin:4px 0 0 0;
  font-size:14px;
}

/* ========== TARJETAS DEL MEN√ö ========== */
.menu-tarjetas{
  display:flex;
  flex-direction:column;
  gap:10px;
  padding:0 16px;
}

.card-btn{
  background:#f5f5f5;
  border:1px solid #e0e0e0;
  border-radius:10px;
  padding:16px;
  text-align:left;
  font-size:16px;
}

/* ========== HEADER CON BOT√ìN REDONDO ========== */
.screen-header{
  display:flex;
  align-items:center;
  gap:10px;
  padding:12px 16px;
  border-bottom:1px solid #eee;
}

.btn-back{
  width:38px;
  height:38px;
  border-radius:50%;
  border:none;
  background:#6b5cff;
  color:white;
  font-size:18px;
}

/* ========== FORMULARIO NUEVO VIAJE ========== */
.screen-container{
  padding:16px;
}

.card{
  border:1px solid #eee;
  border-radius:12px;
  padding:16px;
}

input, select{
  width:100%;
  padding:10px;
  margin:6px 0 12px 0;
  border:1px solid #ccc;
  border-radius:8px;
}

</style>
</head>

<body>

<!-- ================= SPLASH ================= -->
<div id="splashScreen" class="screen active"
     style="display:flex; flex-direction:column;
            align-items:center; justify-content:center;
            gap:16px;">

  <img src="logo.png" width="120" alt="COT Logo">

  <div class="splash-text">Cargando aplicaci√≥n‚Ä¶</div>
</div>


<!-- ================= REGISTRO ================= -->
<div id="registroScreen" class="screen">
  <div class="screen-container">
    <h2>Registro del Chofer</h2>

    <label>Legajo</label>
    <input id="regLegajo">

    <label>Nombre</label>
    <input id="regNombre">

    <label>Base / Punta de inicio</label>
    <select id="regBase">
      <option value="Montevideo">Montevideo</option>
      <option value="Colonia">Colonia</option>
      <option value="Maldonado">Maldonado</option>
      <option value="Punta del Este">Punta del Este</option>
      <option value="Rocha">Rocha</option>
      <option value="Chuy">Chuy</option>
      <option value="Otro">Otro</option>
    </select>

    <button onclick="registrarChofer()">Guardar y continuar</button>
  </div>
</div>

<!-- ================= MAIN SCREEN ================= -->
<div id="mainScreen" class="screen">

  <div class="header-bar">
    <h1>Gesti√≥n de Viajes</h1>
    <p>Sistema de control de flota</p>
    <p id="baseChoferBadge">Base: ‚Äî</p>
  </div>

  <div class="screen-container">
    <h3>Estado de la jornada</h3>
    <div id="ordenActivaInfo" style="
  margin-bottom:10px;
  padding:8px;
  background:#eef2ff;
  border-radius:8px;
  font-size:14px;
">
  Sin jornada activa
</div>
    <div id="viajeEnCursoContainer"></div>
    <p id="ordenActivaInfo">üî¥ Sin jornada activa</p>

    <div style="display:flex; gap:8px; margin-bottom:16px;">
      <button onclick="createOrderUI()">‚ñ∂Ô∏è Iniciar Jornada</button>
      <button onclick="closeActiveOrderUI()">‚èπÔ∏è Cerrar Jornada</button>
    </div>

    <h3>Operaciones del d√≠a</h3>

    <div class="menu-tarjetas">
      <button class="card-btn" onclick="abrirViajeSimple()">üöó Nuevo Viaje</button>
      <button class="card-btn" onclick="showScreen('listaViajesScreen')">üìÑ Ver Viajes</button>
      <button class="card-btn" onclick="showScreen('nuevaGuardiaScreen')">‚ûï Registrar Guardia</button>
      <button class="card-btn" onclick="showScreen('listaGuardiasScreen')">üïí Ver Guardias</button>
    </div>
  </div>
</div>

<!-- ================= NUEVO VIAJE ================= -->
<div id="travelScreen" class="screen">

  <div class="screen-header">
    <button class="btn-back" onclick="showScreen('mainScreen')">‚Üê</button>
    <div>
      <h3 style="margin:0;">Nuevo Viaje</h3>
      <small id="orderNumberTravels"></small>
    </div>
  </div>

  <div class="screen-container">
    <div class="card">
      <label>Origen</label>
      <select id="originTravels"></select>

      <label>Destino</label>
      <input id="destinationTravels" oninput="autoKmPorDestino(false)">

      <!-- SUGERENCIAS PRIMERO -->
      <div id="sugerenciasRutas"
           style="display:none; border:1px solid #ddd; border-radius:8px;
                  max-height:160px; overflow:auto; margin-bottom:10px;">
      </div>

      <!-- HORARIOS COT DESPU√âS -->
      <div id="horariosOficiales"
           style="display:none; border:1px solid #ddd; border-radius:8px;
                  padding:8px; margin-bottom:10px;">
      </div>

      <label>Servicio</label>
      <select id="numeroServicio" onchange="actualizarInfoServicio()">
        <option value="">Eleg√≠ servicio...</option>
        <option value="TURNO">Turno</option>
        <option value="SEMI">Semi-directo</option>
        <option value="DIRECTO">Directo</option>
        <option value="EXPRESO">Expreso</option>
        <option value="CONTRATADO">Contratado</option>
        <option value="PASAJERO">Pasajero</option>
      </select>

      <label>Kil√≥metros (auto)</label>
<input id="kmTravels" type="number">

      <label>Hora salida</label>
      <input id="departureTimeTravels" type="time">

      <label>Hora llegada</label>
      <input id="arrivalTimeTravels" type="time">

      <label>
        <input type="checkbox" id="idaYVueltaAuto">
        Generar vuelta autom√°tica
      </label>

      <button onclick="addTravelUI(event)">Guardar Viaje</button>
    </div>
  </div>
</div>

<!-- ================= LISTA VIAJES ================= -->
<div id="listaViajesScreen" class="screen">

  <!-- HEADER FIJO -->
  <div class="header-fijo">

    <button onclick="showScreen('mainScreen')">‚Üê Volver</button>

    <h2>Lista de Viajes</h2>

    <div id="resumenDia"></div>

  </div>

  <!-- CONTENIDO CON SCROLL -->
  <div class="contenido-scroll">

    <div id="cardsViajesContainer"></div>

  </div>

</div>
<!-- ================= DETALLE ORDEN ================= -->
<div id="detalleOrdenScreen" class="screen">

  <!-- HEADER FIJO -->
  <div class="header-fijo">

    <button onclick="showScreen('listaViajesScreen')">‚Üê Volver</button>

    <h2>Detalle de Jornada</h2>

  </div>

  <!-- CONTENIDO CON SCROLL -->
  <div class="contenido-scroll">

    <div id="detalleOrdenContainer"></div>

  </div>

</div>
<!-- ================= GUARDIAS ================= -->
<div id="nuevaGuardiaScreen" class="screen">
  <button onclick="showScreen('mainScreen')">‚Üê Volver</button>
  <h2>Registrar Guardia</h2>

  <form onsubmit="addGuardUI(event); return false;">
    <label>D√≠a</label>
    <input id="diaGuardia" type="date">

    <label>Hora inicio</label>
    <input id="horaInicioGuardia" type="time">

    <label>Hora fin</label>
    <input id="horaFinGuardia" type="time">

    <label>Tipo</label>
    <select id="tipoGuardia" onchange="manejarDescripcionGuardia()">
      <option value="">Eleg√≠ tipo...</option>
      <option value="comun">Guardia com√∫n</option>
      <option value="especial">Guardia especial</option>
    </select>

    <div id="boxDescripcionGuardia" style="display:none;">
      <label>Descripci√≥n</label>
      <input id="descripcionGuardia">
    </div>

    <button type="submit">Guardar Guardia</button>
  </form>
</div>

<div id="listaGuardiasScreen" class="screen">
  <button onclick="showScreen('mainScreen')">‚Üê Volver</button>
  <h2>Guardias por d√≠a</h2>
  <div id="cardsGuardiasContainer"></div>
</div>

 
<script src="core.js"></script>
<script src="schedules_cot.js"></script>
<script src="routes_utils.js"></script>
<script src="ui_summary.js"></script>
<script src="ui_navigation.js"></script>
<script src="ui_travels.js"></script>
<script src="travel_stats.js"></script>
<script src="ui_guards.js"></script>
<script src="app_bootstrap.js"></script>




<script>
// ===== FLUJO DE ARRANQUE CORRECTO =====
document.addEventListener('DOMContentLoaded', ()=>{
  showScreen('splashScreen');

  setTimeout(()=>{
    const driver = getDriver();

    if(!driver){
      showScreen('registroScreen');
    } else {
      document.getElementById('baseChoferBadge').innerText =
        "Base: " + (driver.base || "Montevideo");

      const sel = document.getElementById('originTravels');
      const bases = ['Montevideo','Colonia','Maldonado','Punta del Este','Rocha','Chuy','Otro'];
      sel.innerHTML = bases.map(b =>
        `<option value="${b}" ${b===driver.base?'selected':''}>${b}</option>`
      ).join('');

      showScreen('mainScreen');
    }
  }, 900);
});

function registrarChofer(){
  const legajo = regLegajo.value.trim();
  const nombre = regNombre.value.trim();
  const base = regBase.value;

  if(!legajo || !nombre){
    alert("Complet√° legajo y nombre");
    return;
  }

  initDriverProfile({legajo, nombre, base});
  document.getElementById('baseChoferBadge').innerText = "Base: " + base;

  const sel = document.getElementById('originTravels');
  const bases = ['Montevideo','Colonia','Maldonado','Punta del Este','Rocha','Chuy','Otro'];
  sel.innerHTML = bases.map(b =>
    `<option value="${b}" ${b===base?'selected':''}>${b}</option>`
  ).join('');

  showScreen('mainScreen');
}
</script>

</body>
</html>




































































