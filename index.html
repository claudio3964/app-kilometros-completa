<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de Viajes</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* üÜï ESTILOS PARA LAS PANTALLAS NUEVAS */
        .screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            z-index: 1000;
            background: white;
        }
        
        .screen.active {
            display: flex;
            flex-direction: column;
        }
        
        /* SPLASH SCREEN */
        #splashScreen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-family: Arial, sans-serif;
        }
        
        .splash-container {
            animation: fadeIn 1s ease-in;
        }
        
        .splash-logo {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        /* LOGIN SCREEN */
        #loginScreen {
            background: #f5f5f5;
            align-items: center;
            justify-content: center;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        .login-container {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .login-container h2 {
            margin-bottom: 1.5rem;
            color: #333;
        }
        
        .login-container input,
        .login-container select {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        .login-container button {
            width: 100%;
            padding: 12px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            margin-top: 1rem;
            cursor: pointer;
        }
        
        .login-container button:hover {
            background: #45a049;
        }
        
        .note {
            font-size: 0.8rem;
            color: #666;
            margin-top: 1rem;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- üÜï PANTALLAS NUEVAS -->
    <div id="splashScreen" class="screen active">
        <div class="splash-container">
            <div class="splash-logo">üöå</div>
            <h1>Gesti√≥n de Viajes</h1>
            <p>Cargando aplicaci√≥n...</p>
        </div>
    </div>

    <div id="loginScreen" class="screen">
        <div class="login-container">
            <h2>üëã ¬°Bienvenido!</h2>
            <input type="text" id="userNumber" placeholder="N¬∫ de Funcionario" maxlength="10">
            <input type="text" id="userName" placeholder="Nombre completo">
            <select id="userRole">
                <option value="conductor">Conductor</option>
                <option value="administrativo">Administrativo</option>
            </select>
            <button onclick="guardarUsuario()">Comenzar a Usar</button>
            <p class="note">* Estos datos se guardar√°n localmente en tu dispositivo</p>
        </div>
    </div>

    <!-- üöó TU APP ACTUAL (NO MODIFICADA) -->
    <div class="container">
        <!-- PANTALLA PRINCIPAL -->
        <div id="mainScreen" class="screen">
            <!-- LOGO -->
            <div class="logo-container">
                <div class="app-logo">üöå</div>
                <h1 class="app-title">Gesti√≥n de Viajes</h1>
                <p class="app-subtitle">Sistema de control de flota</p>
            </div>

            <!-- MEN√ö DE BOTONES -->
            <div class="menu-container">
                <h2 class="menu-title">¬øQu√© deseas hacer?</h2>
                
                <div class="button-grid">
                    <button class="menu-btn primary" onclick="showScreen('travelScreen')">
                        <span class="btn-icon">üöó</span>
                        <span class="btn-text">Nuevo Viaje</span>
                        <span class="btn-desc">Registrar nuevo viaje</span>
                    </button>

                    <button class="menu-btn secondary" onclick="showScreen('guardScreen')">
                        <span class="btn-icon">üõ°Ô∏è</span>
                        <span class="btn-text">Nueva Guardia</span>
                        <span class="btn-desc">Agregar turno de guardia</span>
                    </button>

                    <button class="menu-btn info" onclick="showScreen('travelListScreen')">
                        <span class="btn-icon">üìã</span>
                        <span class="btn-text">Ver Viajes</span>
                        <span class="btn-desc">Lista de viajes registrados</span>
                    </button>

                    <button class="menu-btn warning" onclick="showScreen('guardListScreen')">
                        <span class="btn-icon">üë•</span>
                        <span class="btn-text">Ver Guardias</span>
                        <span class="btn-desc">Lista de guardias activas</span>
                    </button>

                    <button class="menu-btn success" onclick="showScreen('reportsScreen')">
                        <span class="btn-icon">üìä</span>
                        <span class="btn-text">Reportes</span>
                        <span class="btn-desc">Estad√≠sticas y reportes</span>
                    </button>

                    <button class="menu-btn dark" onclick="showScreen('backupScreen')">
                        <span class="btn-icon">üíæ</span>
                        <span class="btn-text">Backup</span>
                        <span class="btn-desc">Exportar/importar datos</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- RESUMEN R√ÅPIDO -->
        <div class="quick-stats" style="display: none;">
            <div class="stat-item">
                <span class="stat-number" id="totalTravels">0</span>
                <span class="stat-label">Total Viajes</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalKm">0</span>
                <span class="stat-label">KM Totales</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalViaticos">0</span>
                <span class="stat-label">Vi√°ticos</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalGuards">0</span>
                <span class="stat-label">Guardias</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalGuardHours">0</span>
                <span class="stat-label">Horas Guardia</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="todayTravels">0</span>
                <span class="stat-label">Viajes Hoy</span>
            </div>
        </div>

        <!-- PANTALLA VIAJES -->
        <div id="travelScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="showScreen('mainScreen')">‚Üê Volver</button>
                <h2>üöó Nuevo Viaje</h2>
            </div>
            <button type="button" onclick="agregarDestinoManual()" class="btn-secondary">
                ‚ûï Agregar Nuevo Destino
            </button>
            <div class="form-container">
                <!-- SELECTOR DE MODO -->
                <div class="mode-selector" style="margin-bottom: 20px;">
                    <button type="button" id="btnRegular" class="mode-btn active" onclick="setMode('regular')">
                        üöå SERVICIO REGULAR
                    </button>
                    <button type="button" id="btnContratado" class="mode-btn" onclick="setMode('contratado')">
                        üìù SERVICIO CONTRATADO
                    </button>
                </div>

                <form id="travelFormDetailed" onsubmit="addTravel(event)">
                    <!-- MODO REGULAR -->
                    <div id="modoRegular">
                        <div class="form-group">
                            <label>üîç Buscar Ruta Regular:</label>
                            <input type="text" id="buscarRuta" class="form-control" 
                                   placeholder="Ej: Punta del Este, Colonia, Chuy..." 
                                   oninput="buscarRutas(this.value)">
                            <div id="sugerenciasRutas" class="sugerencias-container"></div>
                        </div>

                        <div class="form-group">
                            <label>üöå Servicio:</label>
                            <select id="numeroServicio" class="form-control" onchange="actualizarInfoServicio()">
                                <option value="">Primero eleg√≠ una ruta...</option>
                            </select>
                        </div>

                        <!-- INFO AUTOM√ÅTICA -->
                        <div id="infoAuto" class="info-auto" style="display: none;">
                            <div class="info-item">
                                <span class="info-label">Tipo de Servicio:</span>
                                <span id="autoTipo" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Acoplado:</span>
                                <span id="autoAcoplado" class="info-value">-</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Reglas:</span>
                                <span id="autoReglas" class="info-value">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- MODO CONTRATADO -->
                    <div id="modoContratado" style="display: none;">
                        <div class="form-group">
                            <label>üìç Destino Contratado:</label>
                            <input type="text" id="destinoContratado" class="form-control" 
                                   placeholder="Ej: Hotel XYZ, Empresa ABC...">
                        </div>

                        <div class="form-group">
                            <label>üî¢ N√∫mero de Servicio:</label>
                            <input type="text" id="numeroContratado" class="form-control" 
                                   placeholder="N√∫mero espec√≠fico...">
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div class="form-group">
                                <label>üé´ Tipo de Servicio:</label>
                                <select id="tipoContratado" class="form-control">
                                    <option value="DIRECTO">DIRECTO</option>
                                    <option value="SEMI-DIRECTO">SEMI-DIRECTO</option>
                                    <option value="TURNO">TURNO</option>
                                    <option value="REGULAR">REGULAR</option>
                                    <option value="ESPECIAL">ESPECIAL</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>üîß Acoplado:</label>
                                <select id="acopladoContratado" class="form-control">
                                    <option value="false">NO</option>
                                    <option value="true">S√ç</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- CAMPOS COMUNES -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div class="form-group">
                            <label for="orderNumberTravels">N√∫mero de Orden *</label>
                            <input type="text" id="orderNumberTravels" required>
                        </div>
                        <div class="form-group">
                            <label for="originTravels">Origen *</label>
                            <input type="text" id="originTravels" required readonly style="background-color: #f8f9fa;">
                        </div>
                        <div class="form-group">
                            <label for="destinationTravels">Destino *</label>
                            <input type="text" id="destinationTravels" required readonly style="background-color: #f8f9fa;">
                        </div>
                        
                        <div class="form-group">
                            <label for="kmTravels">Kil√≥metros *</label>
                            <input type="number" id="kmTravels" step="0.1" required>
                        </div>
                        <div class="form-group">
                            <label for="departureTimeTravels">Hora Salida *</label>
                            <input type="time" id="departureTimeTravels" required>
                        </div>
                        <div class="form-group">
                            <label for="arrivalTimeTravels">Hora Llegada *</label>
                            <input type="time" id="arrivalTimeTravels" required>
                        </div>
                    </div>

                    <button type="submit" class="btn-primary">‚ûï Agregar Viaje</button>
                </form>
            </div>
        </div>

        <!-- PANTALLA GUARDIAS -->
        <div id="guardScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="showScreen('mainScreen')">‚Üê Volver</button>
                <h2>üõ°Ô∏è Nueva Guardia</h2>
            </div>
            <div class="form-container">
                <form id="guardForm" onsubmit="addGuard(event)">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="form-group">
                            <label for="guardOrderNumber">N√∫mero de Orden *</label>
                            <input type="text" id="guardOrderNumber" required>
                        </div>

                        <div class="form-group">
                            <label for="guardStartTime">Hora Inicio *</label>
                            <input type="time" id="guardStartTime" required>
                        </div>
                        <div class="form-group">
                            <label for="guardEndTime">Hora Fin *</label>
                            <input type="time" id="guardEndTime" required>
                        </div>
                         <!-- CAMPO DE TARIFA -->
                        <div class="form-group">
                            <label for="guardTarifa">Tipo de Guardia</label>
                            <select id="guardTarifa" onchange="actualizarDescripcionGuardia()">
                                <option value="30">Com√∫n - $30/hora</option>
                                <option value="40">Especial - $40/hora</option>
                            </select>
                        </div>
                    </div>
                    <!-- CAMPO DE TEXTO PARA DESCRIPCI√ìN -->
                    <div id="campoDescripcion" class="form-group" style="display: none;">
                        <label for="guardDescripcion">üìù Descripci√≥n del Movimiento Especial *</label>
                        <textarea id="guardDescripcion" rows="3" placeholder="Ej: Traslado especial a hotel, Servicio fuera de horario, Movimiento extra..."></textarea>
                        <small style="color: #666;">Describe brevemente por qu√© es una guardia especial</small>
                    </div>
                    <button type="submit" class="btn-primary">‚ûï Agregar Guardia</button>
                </form>
            </div>
        </div>

        <!-- PANTALLA BACKUP -->
        <div id="backupScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="showScreen('mainScreen')">‚Üê Volver</button>
                <h2>üíæ Backup y Restauraci√≥n</h2>
            </div>
            <div class="form-container">
                <!-- EXPORTAR DATOS -->
                <div style="margin-bottom: 30px;">
                    <h4 style="color: #27ae60; margin-bottom: 15px;">üì§ Exportar Datos</h4>
                    <div class="backup-actions">
                        <button class="backup-btn" onclick="exportData()">üíæ Backup Completo</button>
                        <button class="backup-btn" onclick="exportTravels()">üöó Solo Viajes</button>
                        <button class="backup-btn" onclick="exportGuards()">üõ°Ô∏è Solo Guardias</button>
                    </div>
                </div>
                
                <!-- IMPORTAR DATOS -->
                <div style="margin-bottom: 30px;">
                    <h4 style="color: #3498db; margin-bottom: 15px;">üì• Importar Datos</h4>
                    <div class="form-group">
                        <label for="backupFile">Seleccionar archivo JSON de backup</label>
                        <input type="file" id="backupFile" accept=".json">
                        <div id="importStatus" style="margin-top: 10px; font-weight: bold;"></div>
                    </div>
                    <button class="backup-btn" onclick="importData()" style="margin-top: 10px;">üîÑ Restaurar Backup</button>
                </div>
                
                <!-- HERRAMIENTAS -->
                <div>
                    <h4 style="color: #e74c3c; margin-bottom: 15px;">‚öôÔ∏è Herramientas</h4>
                    <div class="backup-actions">
                        <button class="backup-btn warning" onclick="generateSampleData()">üéØ Generar Datos de Ejemplo</button>
                        <button class="backup-btn danger" onclick="clearAllData()">üóëÔ∏è Eliminar Todos los Datos</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- LISTA DE VIAJES -->
        <div id="travelListScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="showScreen('mainScreen')">‚Üê Volver</button>
                <h2>üìã Lista de Viajes</h2>
            </div>
            
            <div class="lista-container" id="allTravelsList">
                <div class="no-data">No hay viajes registrados</div>
            </div>
        </div>

        <!-- LISTA DE GUARDIAS -->
        <div id="guardListScreen" class="screen">
            <div class="screen-header">
                <button class="back-btn" onclick="showScreen('mainScreen')">‚Üê Volver</button>
                <h2>üë• Lista de Guardias</h2>
            </div>
            
            <div class="lista-container" id="allGuardsList">
                <div class="no-data">No hay guardias registradas</div>
            </div>
        </div>
        
        <!-- PANTALLA DE REPORTES -->
        <div id="reportsScreen" class="screen">
    <div class="screen-header">
        <button class="back-btn" onclick="showScreen('mainScreen')">‚Üê Volver</button>
        <h2>üìä Reportes y B√∫squedas</h2>
    </div>

    <!-- üéõÔ∏è PANEL DE FILTROS -->
    <div class="filters-panel">
        <div class="filter-group">
            <label>üìÖ Fecha Desde:</label>
            <input type="date" id="filterDateFrom" class="form-control">
        </div>
        <div class="filter-group">
            <label>üìÖ Fecha Hasta:</label>
            <input type="date" id="filterDateTo" class="form-control">
        </div>
        <div class="filter-group">
            <label>üî¢ N¬∫ de Orden:</label>
            <input type="text" id="filterOrderNumber" class="form-control" placeholder="Ej: ORD-001">
        </div>
        <div class="filter-group">
            <label>üë§ Conductor:</label>
            <input type="text" id="filterDriver" class="form-control" placeholder="Buscar conductor...">
        </div>
        <div class="filter-actions">
            <button class="btn-primary" onclick="generarReporte()">üîç Generar Reporte</button>
            <button class="btn-secondary" onclick="limpiarFiltros()">üîÑ Limpiar</button>
        </div>
    </div>

    <!-- üìä RESUMEN R√ÅPIDO -->
    <div class="report-summary">
        <div class="summary-item">
            <span class="summary-label">Total Viajes:</span>
            <span class="summary-value" id="totalViajesReport">0</span>
        </div>
        <div class="summary-item">
            <span class="summary-label">Total KM:</span>
            <span class="summary-value" id="totalKmReport">0</span>
        </div>
        <div class="summary-item">
            <span class="summary-label">Total Horas:</span>
            <span class="summary-value" id="totalHorasReport">0</span>
        </div>
        <div class="summary-item">
            <span class="summary-label">Total Vi√°ticos:</span>
            <span class="summary-value" id="totalViaticosReport">$0</span>
        </div>
    </div>

    <!-- üìã TABLA DE RESULTADOS (ESTILO PROFESIONAL) -->
    <div class="report-results">
        <div class="report-header">
            <h3>üìã Resultados del Reporte</h3>
            <div class="report-actions">
                <span id="resultCount" class="result-count">0 registros encontrados</span>
                <button class="btn-success" onclick="exportarReporte()">üìÑ Exportar a PDF</button>
            </div>
        </div>
        
        <div class="table-container">
            <table class="report-table">
                <thead>
                    <tr>
                        <th>Fecha</th>
                        <th>N¬∫ Orden</th>
                        <th>Conductor</th>
                        <th>Ruta</th>
                        <th>KM</th>
                        <th>Horas</th>
                        <th>Vi√°ticos</th>
                        <th>Tipo Servicio</th>
                    </tr>
                </thead>
                <tbody id="reportResultsBody">
                    <tr>
                        <td colspan="8" class="no-data">Usa los filtros para generar un reporte</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

    <!-- üÜï SCRIPT NUEVO PARA EL LOGIN -->
    <script>
        // üéØ VARIABLE GLOBAL PARA EL USUARIO
        let usuario = {
            numero: '',
            nombre: '', 
            rol: ''
        };

        // üéØ FUNCI√ìN PARA GUARDAR USUARIO (LOGIN)
        function guardarUsuario() {
            const numero = document.getElementById('userNumber').value.trim();
            const nombre = document.getElementById('userName').value.trim();
            const rol = document.getElementById('userRole').value;
            
            // Validar campos
            if (!numero) {
                alert('Por favor ingresa tu n√∫mero de funcionario');
                return;
            }
            
            if (!nombre) {
                alert('Por favor ingresa tu nombre');
                return;
            }
            
            // Guardar datos del usuario
            usuario = { 
                numero: numero, 
                nombre: nombre, 
                rol: rol 
            };
            
            // Guardar en localStorage
            localStorage.setItem('travelUser', JSON.stringify(usuario));
            
            // Ocultar login y mostrar app principal
            document.getElementById('loginScreen').classList.remove('active');
            document.getElementById('mainScreen').classList.add('active');
            
            console.log('‚úÖ Usuario guardado:', usuario);
        }

        // üéØ FUNCI√ìN PARA CARGAR USUARIO AL INICIAR
        function cargarUsuario() {
            const usuarioGuardado = localStorage.getItem('travelUser');
            
            if (usuarioGuardado) {
                // Usuario ya existe, cargar datos
                usuario = JSON.parse(usuarioGuardado);
                console.log('‚úÖ Usuario cargado:', usuario);
                
                // Ocultar splash y mostrar app principal directamente
                setTimeout(() => {
                    document.getElementById('splashScreen').classList.remove('active');
                    document.getElementById('mainScreen').classList.add('active');
                }, 1000);
                
            } else {
                // Primer uso, mostrar login despu√©s del splash
                setTimeout(() => {
                    document.getElementById('splashScreen').classList.remove('active');
                    document.getElementById('loginScreen').classList.add('active');
                }, 2000);
            }
        }

        // üéØ FUNCI√ìN PARA CORREGIR USUARIO (OPCIONAL)
        function corregirUsuario() {
            if (confirm('¬øDeseas cambiar tus datos de usuario?\n\nEsto te llevar√° a la pantalla de configuraci√≥n inicial.')) {
                // Eliminar usuario guardado
                localStorage.removeItem('travelUser');
                // Ocultar app y mostrar login
                document.getElementById('mainScreen').classList.remove('active');
                document.getElementById('loginScreen').classList.add('active');
            }
        }

        // üéØ INICIAR LA APLICACI√ìN
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Iniciando aplicaci√≥n...');
            cargarUsuario();
        });
    </script>

    <!-- üöó TU SCRIPT ACTUAL -->
    <script src="app.js"></script>
</body>
</html>

































































































